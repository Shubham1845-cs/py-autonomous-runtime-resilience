{% extends "base.html" %}

{% block title %}Telemetry Monitor | AutoHeal-Py{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Telemetry Monitor</h1>
    <p>Detailed metrics and health analysis for all monitored services</p>
</div>

<div class="container">
    <div class="monitor-controls">
        <select id="service-selector" class="select-input">
            <option value="">Select a service...</option>
        </select>
        <select id="time-range" class="select-input">
            <option value="60">Last 1 minute</option>
            <option value="300" selected>Last 5 minutes</option>
            <option value="900">Last 15 minutes</option>
            <option value="3600">Last 1 hour</option>
        </select>
    </div>

    <div id="service-detail" class="service-detail hidden">
        <div class="detail-header">
            <h2 id="detail-service-name">Service Name</h2>
            <span id="detail-status-badge" class="status-badge">Healthy</span>
        </div>

        <div class="metrics-grid">
            <div class="metric-box">
                <div class="metric-label">Failure Rate</div>
                <div class="metric-value" id="detail-failure-rate">0%</div>
            </div>
            <div class="metric-box">
                <div class="metric-label">Avg Latency</div>
                <div class="metric-value" id="detail-latency">0s</div>
            </div>
            <div class="metric-box">
                <div class="metric-label">Total Calls</div>
                <div class="metric-value" id="detail-calls">0</div>
            </div>
            <div class="metric-box">
                <div class="metric-label">Window</div>
                <div class="metric-value" id="detail-window">60s</div>
            </div>
        </div>

        <div class="recommendation-box" id="recommendation-box" style="display: none;">
            <h3>ðŸŽ¯ Recommended Pattern</h3>
            <div class="recommendation-content">
                <div class="rec-pattern" id="rec-pattern">Circuit Breaker</div>
                <div class="rec-reason" id="rec-reason">High failure rate detected</div>
            </div>
        </div>

        <div class="metrics-table-container">
            <h3>Recent Calls</h3>
            <table class="metrics-table">
                <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Duration (s)</th>
                        <th>Status</th>
                        <th>Error</th>
                    </tr>
                </thead>
                <tbody id="metrics-table-body">
                    <tr>
                        <td colspan="4" class="empty-state">Select a service to view metrics</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/monitor.js') }}"></script>
{% endblock %}